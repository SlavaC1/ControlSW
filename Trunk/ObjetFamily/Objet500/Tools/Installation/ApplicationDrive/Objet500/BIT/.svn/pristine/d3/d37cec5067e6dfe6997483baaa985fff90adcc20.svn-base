################################################################################################
#
# 	Description: Ambient temperature and interlock tests
#
# 	Version:	$Rev$
# 	Date:		$Date$
# 	Path:		$HeadURL$ 
#
################################################################################################

from Q2RT_BIT import * 

# Cabin sensor range
MIN_CABIN_REASONABLE_A2D_VALUE = 330
MAX_CABIN_REASONABLE_A2D_VALUE = 430
class CabinSensorTest(SingleTest):
  def GetSteps(Self):
    return ['Test Cabin Sensor']

  def Execute(Self,Step):  
    # Read cabin temperature and check if reasonable value
    CabinTemp = AmbientTemperature.GetCurrentTemperatureA2D()

    if CabinTemp < MIN_CABIN_REASONABLE_A2D_VALUE or CabinTemp > MAX_CABIN_REASONABLE_A2D_VALUE:
      Self.SetActualVsRequested(str(MIN_CABIN_REASONABLE_A2D_VALUE) + ' - ' + str(MAX_CABIN_REASONABLE_A2D_VALUE),CabinTemp,'Error')
      Self.SetResultDescription('Cabin temperature sensor is not within requested range')
      return trNoGo

    Self.SetActualVsRequested(str(MIN_CABIN_REASONABLE_A2D_VALUE) + ' - ' + str(MAX_CABIN_REASONABLE_A2D_VALUE),CabinTemp,'A/D units')
    return trGo


def GetTests():
  return [CabinSensorTest('Cabin Temperature',taHighPriority)]

